<!--
https://ae01.alicdn.com/kf/Haf4d3b0529ba47669bf69c7bfc71a5f1Y.png
计算机基础
TCP握手协议
TCP三次握手和四次挥手流程
TCP三次握手和四次挥手流程
-->

## TCP握手协议

> TCP三次握手和四次挥手流程

#### 三次握手
![三次握手](https://ae01.alicdn.com/kf/H3f7818584e11403b8ee30f7a89764b07c.png)
1、SYN=1、ACK=0、seq=x  
2、SYN=1、ACK=1、seq=y、ack=x+1  
3、       ACK=1、seq=x+1、ack=y+1


#### 为什么不是两次或者五次握手
1、当两次握手的时候，会存在一种现象。  
当首次握手，因为网络等原因，没有及时的送法服务端，也就是请求超时了。客户端再次发送了请求，并完成握手和数据传递。

而首次握手的请求只是阻塞，没有消失，当他再次到达服务器端的时候，服务端会立即分配资源等待后续响应。
因为只有两次握手，此次握手已经完成，也就是客户端是不会理会此次握手的，因为已经完成了资源的请求。

相反，在三次握手中，出现此种情况的时候，客户端接收到此次异常请求，遵循三次握手准则，
仍然会响应请求，但是此次的连接时复位连接，也就是会要求服务端释放相关资源。

2、当三次握手可以完成要求的时候，四次、五次就一定可以完成，不过会浪费资源。


#### 四次挥手
1、FIN=1、seq=u  
2、ACK=1、ack=u+1、seq=v    
3、FIN=1、ack=v+1、seq=w  
4、ACK=1、acl=w+1、seq=v+1  

#### 什么时http协议  
http协议是应用层通信协议。分为请求报文和响应报文。  
请求报文：  
> 报文头：GET / http （由请求方法、请求路径、协议版本组成报文头）
> 请求头：key:value
>   
> body

响应报文：
> 报文头：200 ok （响应状态码）  
> 响应头：key:value  
>  
> 响应正文：body

一次完成的请求，有一个封包的过程。  
即http请求封装到应用数据包 - 封装到tcp数据包 - 封装到ip数据包 - 封装到以太网数据包  
如果以太网数据包过大，会被拆分成多个数据包发送

#### http1.0、1.1、2.0有什么区别
1、http1.0  
默认位短链接，可以通过keep-alive来保持长连接。  
当网页存在大量的css、js、img的时候，比如由30个请求，则意味着，会重复30多次tcp连接/断开的过程，
这个过程是非常的消耗资源的。

2、http1.1  
默认是支持长连接，即tcp创建连接后不会断开，后续的请求，都会通过该tcp连接来响应资源。

3、http2.0  
支持多路复用，即基于一个tcp请求并行发送多个请求即接收响应，解决了http1.1中同一时间同一域名请求限制的问题。  
支持二进制分帧，也就是能够切割出更小的数据包，提高传递性能。

#### 什么是https
![https流程](https://ae01.alicdn.com/kf/Hce6b502bad92422c8ec30bdbb19df9d6G.png)

基于第三方认证的加密请求。第三方认证会以证书的形式表现。  

即访问服务器的时候，会发送证书到浏览器，里面包括：网站地址、加密公钥、颁布机构  
然后浏览器验证证书的合法性，如果ok，则会出现一把锁的标志。

再然后浏览器会生成一个随机密码，并用证书中的公钥进行加密，然后发送一段消息及消息的hash值，
将这三个份数据发给服务器，服务器用私钥解密随机密码，然后用解密得到的随机密码对消息解密，
得到消息后，使用hash计算并对于传送过来的hash值，判断此条消息是否被篡改。

然后服务器也发送一段消息及其hash值，使用随机密码进行加密，发送给浏览器。  
并约定后续所有的访问请求，均使用此此种方法进行通信。

